<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Construction Check-sheet</title>
  <style>
    /* Your existing CSS here */
    /* Example minimal styling */
    label { display: block; margin-top: 0.5em; }
    .checkbox-group { margin-bottom: 1em; }
    input[type="text"], input[type="date"] { width: 100%; padding: 6px; margin-top: 2px; }
  </style>
</head>
<body>
  <h1>Construction Check-sheet</h1>

  <form id="main-form" method="POST" action="YOUR_WEB_APP_URL" onsubmit="return handleFormSubmit(event)">
    <!-- Basic Info -->
    <label for="building">Building Name:</label>
    <input type="text" id="building" name="building" required />

    <label for="phase">Phase:</label>
    <input type="text" id="phase" name="phase" required />

    <label for="foreman">Foreman:</label>
    <input type="text" id="foreman" name="foreman" required />

    <!-- Example Checkbox Group: ELF -->
    <fieldset class="checkbox-group">
      <legend>ELF</legend>
      <label><input type="checkbox" name="elf[]" value="Mounted"> Mounted</label>
      <label><input type="checkbox" name="elf[]" value="Painted"> Painted</label>
      <label><input type="checkbox" name="elf[]" value="Wiring Checked"> Wiring Checked</label>
      <!-- Add more checkboxes as needed -->
      <label>Notes (comma separated for each checkbox):</label>
      <input type="text" name="elf_notes[]" placeholder="Notes for ELF" />
    </fieldset>

    <!-- Similarly add your other checkbox groups like labels, clearance, etc. -->
    <!-- Example Labels Group -->
    <fieldset class="checkbox-group">
      <legend>Labels</legend>
      <label><input type="checkbox" name="labels[]" value="Correct"> Correct</label>
      <label><input type="checkbox" name="labels[]" value="Missing"> Missing</label>
      <label>Notes:</label>
      <input type="text" name="labels_notes[]" placeholder="Notes for Labels" />
    </fieldset>

    <!-- Add all your other checkbox groups and notes following this pattern -->

    <!-- Sign-offs -->
    <h2>Sign Offs</h2>

    <label for="signoff-equipment-name">Equipment Sign Off Name:</label>
    <input type="text" id="signoff-equipment-name" name="signoff-equipment-name" />

    <label for="signoff-equipment-date">Equipment Sign Off Date:</label>
    <input type="date" id="signoff-equipment-date" name="signoff-equipment-date" />

    <label for="signoff-mounted-name">Mounted Sign Off Name:</label>
    <input type="text" id="signoff-mounted-name" name="signoff-mounted-name" />

    <label for="signoff-mounted-date">Mounted Sign Off Date:</label>
    <input type="date" id="signoff-mounted-date" name="signoff-mounted-date" />

    <label for="signoff-wiring-name">Wiring Sign Off Name:</label>
    <input type="text" id="signoff-wiring-name" name="signoff-wiring-name" />

    <label for="signoff-wiring-date">Wiring Sign Off Date:</label>
    <input type="date" id="signoff-wiring-date" name="signoff-wiring-date" />

    <label for="signoff-secondary-name">Secondary Sign Off Name:</label>
    <input type="text" id="signoff-secondary-name" name="signoff-secondary-name" />

    <label for="signoff-secondary-date">Secondary Sign Off Date:</label>
    <input type="date" id="signoff-secondary-date" name="signoff-secondary-date" />

    <label for="signoff-final-name">Final Sign Off Name:</label>
    <input type="text" id="signoff-final-name" name="signoff-final-name" />

    <label for="signoff-final-date">Final Sign Off Date:</label>
    <input type="date" id="signoff-final-date" name="signoff-final-date" />

    <!-- QCX Fields -->
    <label for="qcxName">QCX Name:</label>
    <input type="text" id="qcxName" name="qcxName" />

    <label for="qcxDate">QCX Date:</label>
    <input type="date" id="qcxDate" name="qcxDate" />

    <button type="submit">Submit</button>
  </form>

  <script>
    async function handleFormSubmit(event) {
      event.preventDefault();

      const form = event.target;

      function getCheckedValues(name) {
        return Array.from(form.querySelectorAll(`input[name="${name}"]:checked`)).map(el => el.value || "Checked");
      }

      function getNotes(name) {
        return Array.from(form.querySelectorAll(`input[name="${name}"]`)).map(el => el.value || '');
      }

      const formData = {
        building: form.querySelector('#building').value,
        phase: form.querySelector('#phase').value,
        foreman: form.querySelector('#foreman').value,

        elf: getCheckedValues('elf[]'),
        elf_notes: getNotes('elf_notes[]'),

        labels: getCheckedValues('labels[]'),
        labels_notes: getNotes('labels_notes[]'),

        // Add other checkbox groups similarly
        // clearance: getCheckedValues('clearance[]'),
        // clearance_notes: getNotes('clearance_notes[]'),

        signoff_equipment_name: form.querySelector('#signoff-equipment-name').value,
        signoff_equipment_date: form.querySelector('#signoff-equipment-date').value,
        signoff_mounted_name: form.querySelector('#signoff-mounted-name').value,
        signoff_mounted_date: form.querySelector('#signoff-mounted-date').value,
        signoff_wiring_name: form.querySelector('#signoff-wiring-name').value,
        signoff_wiring_date: form.querySelector('#signoff-wiring-date').value,
        signoff_secondary_name: form.querySelector('#signoff-secondary-name').value,
        signoff_secondary_date: form.querySelector('#signoff-secondary-date').value,
        signoff_final_name: form.querySelector('#signoff-final-name').value,
        signoff_final_date: form.querySelector('#signoff-final-date').value,

        qcxName: form.querySelector('#qcxName').value,
        qcxDate: form.querySelector('#qcxDate').value,
      };

      try {
        const response = await fetch(form.action, {
          method: 'POST',
          body: JSON.stringify(formData),
          headers: { 'Content-Type': 'application/json' }
        });

        const result = await response.json();

        if (result.status === 'success') {
          alert('Form submitted successfully!');
          form.reset();
        } else {
          alert('Submission error: ' + result.message);
        }
      } catch (err) {
        alert('Submission failed: ' + err.message);
      }

      return false;
    }
  </script>
</body>
</html>
